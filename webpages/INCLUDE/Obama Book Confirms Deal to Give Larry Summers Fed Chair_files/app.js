(()=>{function et(n){return n!=null&&n===n.window}function u(n,e){if(e===void 0&&(e=null),n instanceof HTMLElement||n instanceof Node||et(n))return[n];if(n instanceof NodeList)return[].slice.call(n);if(typeof n=="string"){var t=e?u(e)[0]:document;return[].slice.call(t.querySelectorAll(n))}return[]}function g(n,e){if(Array.isArray(n))return n.forEach(function(i){return g(i,e)});var t=u(n);if(t.length){var s=[].concat(e);return t.forEach(function(i){s.forEach(function(o){i.classList.add(o)})}),t}}function f(n,e,t,s){if(Array.isArray(n)){n.forEach(function(l){return f(l,e,t,s)});return}var i={};typeof s=="boolean"?i.capture=s:typeof s=="object"&&(i=Object.assign({},s));var o={cb:t,options:i};window._domassistevents||(window._domassistevents={}),window._domassistevents["_"+e]=o;var r=u(n);r.length&&r.forEach(function(l){l.addEventListener(e,t,i)})}function J(n,e){var t=Element.prototype,s=!1,i=["matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"];if(i.forEach(function(o){t.hasOwnProperty(o)&&(s=t[o])}),s)return n?s.call(n,e):null}function Be(n,e){do{if(J(n,e))return n;n=n.parentElement||n.parentNode}while(n!==null&&n.nodeType===1);return null}function S(n,e){var t=u(n,e);return t.length?t[0]:null}function tt(){try{var n=new CustomEvent("t",{detail:{a:"b"}});return n.type==="t"&&n.detail.a==="b"}catch{return!1}}var it=function(e,t){var s=document.createEvent("CustomEvent");return t?s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):s.initCustomEvent(e,!1,!1,void 0),s},Q=!1;function v(n,e,t){if(t===void 0&&(t={}),Array.isArray(n))return n.forEach(function(i){return v(i,e,t)});Q||(Q=tt()?CustomEvent:it);var s=u(n);if(s.length)return t.bubbles!==!1&&(t.bubbles=!0),s.forEach(function(i){var o=new Q(e,t);i.dispatchEvent(o)}),s}function Ue(n,e,t){f(n,"mouseenter",e),f(n,"mouseleave",t)}function b(n,e){if(Array.isArray(n))return n.forEach(function(i){return b(i,e)});var t=u(n);if(t.length){var s=[].concat(e);return t.forEach(function(i){s.forEach(function(o){i.classList.remove(o)})}),t}}var st=function(e){return function(t){e.push(t);function s(){for(;e.length;){var o=e.shift();typeof o=="function"&&o()}}function i(){document.removeEventListener("DOMContentLoaded",i),s()}setTimeout(function(){if(document.readyState!=="loading")return s()},0),document.addEventListener("DOMContentLoaded",i)}},C=st([]);function K(n,e){Array.isArray(n)&&n.forEach(function(s){return K(s,e)});var t=u(n);t.length&&t.forEach(function(s){Object.keys(e).forEach(function(i){s.style[i]=e[i]})})}var L={OVERLAY:"offcanvas-overlay",VISIBLE:"visible",OPEN:"open",LOCK_OVERFLOW:"offcanvas-is-open",READY:"offcanvas-ready"},Ve={CANVAS:"[data-offcanvas]",FIXED:"[data-offcanvas-fixed]"},X=function(){function n(t){this.name=t.name,this.el=t.el,this.options=t,this.visible=!1,this.boundSetup=this.setup.bind(this),this.boundToggle=this.toggle.bind(this),this.boundHide=this.hide.bind(this),this.fixedEl=u(Ve.FIXED),this.transitionTime=parseFloat(window.getComputedStyle(this.el).transitionDuration)*1e3,this.setup(),this.setupEvents()}var e=n.prototype;return e.setupEvents=function(){f(window,"resize",this.boundSetup),f(window,"orientationchange",this.boundSetup)},e.destroy=function(){var s=this;this.overlay.removeEventListener("click",this.boundHide),this.options.trigger.forEach(function(i){return i.removeEventListener("click",s.boundToggle)}),this.overlay.parentNode.removeChild(this.overlay),this.overlay=null,this.initialized=!1},e.setup=function(){if(this.options.match&&!window.matchMedia(this.options.match).matches){this.initialized&&this.destroy();return}this.initialized||(this.initialized=!0,this.el.id||(this.el.id="offcanvas-"+this.name),this.updateAria(),this.setupOverlay(),this.setupTriggers(this.options.trigger),setTimeout(function(){g(document.body,L.READY)},this.transitionTime))},e.setupOverlay=function(){this.overlay||(this.overlay=document.createElement("div"),g(this.overlay,L.OVERLAY),document.body.appendChild(this.overlay),this.overlay.addEventListener("click",this.boundHide))},e.setupTriggers=function(s){var i=this;s.forEach(function(o){o.addEventListener("click",i.boundToggle),o.setAttribute("aria-controls",i.el.id)})},e.updateAria=function(){var s=this;this.options.trigger.forEach(function(i){i.setAttribute("aria-expanded",""+s.visible)}),this.el.setAttribute("aria-hidden",""+!this.visible)},e.show=function(){this.visible||(this.visible=!0,g(this.el,L.OPEN),g(this.overlay,L.VISIBLE),g(document.body,L.LOCK_OVERFLOW),v(this.el,"offcanvas:show"),this.fixedEl&&this.fixedEl.forEach(function(s){s.style.top=(document.documentElement.scrollTop||document.body.scrollTop)+"px"}),this.updateAria())},e.hide=function(){var s=this;this.visible&&(this.visible=!1,b(this.el,L.OPEN),b(this.overlay,L.VISIBLE),b(document.body,L.LOCK_OVERFLOW),v(this.el,"offcanvas:hide"),this.fixedEl&&setTimeout(function(){s.fixedEl.forEach(function(i){i.style.top=""})},this.transitionTime),this.updateAria())},e.toggle=function(){this.visible?this.hide():this.show()},n}();X.autoLoad=!0;C(function(){X.autoLoad!==!1&&u(Ve.CANVAS).forEach(function(n){var e=n.getAttribute("data-offcanvas");new X({name:e,el:n,trigger:u('[data-offcanvas-trigger="'+e+'"]'),match:n.getAttribute("data-offcanvas-match")})})});function nt(n,e){var t={};return Object.keys(e.dataset).forEach(function(s){if(s.match(new RegExp("^"+n))&&s!==n){var i=s.replace(n,""),o=!1;i.match(/^Global/)&&(i=i.replace("Global",""),o=!0),i=""+i[0].toLowerCase()+i.slice(1),o?t[i]=window[e.dataset[s]]:t[i]=e.dataset[s],(typeof t[i]>"u"||t[i]==="")&&(t[i]=!0)}}),t}var q=nt;var ot=function(e,t,s){var i;return function(){var o=this,r=arguments,l=function(){i=null,s||e.apply(o,r)},c=s&&!i;clearTimeout(i),i=setTimeout(l,t),c&&e.apply(o,r)}},k=ot;var I={In:"scrolltriggers:inView",Out:"scrolltriggers:outOfView",Pause:"scrolltriggers:pause",Resume:"scrolltriggers:resume",Bounds:"scrolltriggers:bounds"},Z=function(){function n(t,s){var i=this;t.hasAttribute("data-scroll-init")||(this.added=!1,this.el=t,this.options=s,this.eventHandler=k(this.onScroll.bind(this),10,!0),this.dCalcBounds=k(this.calcBounds.bind(this),10),this.paused=!1,this.disabled=!1,this.calcOffset(),(this.options.image||this.options.src||this.options.srcset)&&(this.options.once=!0),t.setAttribute("data-scroll-init","true"),this.calcBounds(),window.addEventListener("scroll",this.eventHandler),window.addEventListener("resize",this.dCalcBounds),f(this.el,I.Pause,function(){i.paused=!0}),f(this.el,I.Resume,function(){i.paused=!1}),setTimeout(this.eventHandler,400))}var e=n.prototype;return e.calcBounds=function(){var s=this;this.calcOffset();var i=this.options.progress===!0||typeof this.options.fixed<"u";if(!this.el.offsetParent&&!i||this.added&&this.options.once){this.disabled=!0;return}if(this.disabled=!1,i&&this.added)return this.outOfView(),requestAnimationFrame(function(){return s.calcBounds()});var o=this.options.position||"bottom";this.startEl=this.options.start?S(this.options.start):this.el,n.checkElement(this.startEl,"start",this.options.start);var r=this.startEl.getBoundingClientRect(),l=n.getScrollY(),c=r.top+l+(this.options.offset||0);if(this.start=n.processPosition(o,c),this.options.end){var h=S(this.options.end),p=h.getBoundingClientRect(),m=p.top+l,y=this.options.positionEnd||"bottom";y==="auto"&&(y="top"),this.end=n.processPosition(y,m),this.options.positionEnd==="auto"&&(this.end-=this.el.offsetHeight),n.checkElement(h,"end",this.options.end)}this.fire(I.Bounds),this.eventHandler()},e.calcOffset=function(){this.options.offset=this.options.offset?this.options.offset:this.el.dataset.scrollOffset,this.options.image||this.options.srcset||this.options.offset==="auto"?this.options.offset=Math.max(document.documentElement.clientHeight,window.innerHeight,0)*-1:this.options.offset=parseInt(this.options.offset||0,10)},e.inView=function(){var s=this.options,i=s.className,o=s.inView;i&&this.el.classList&&g(this.el,i);var r=this.options.image,l=this.options.src,c=this.options.srcset;if(r||l){var h=r||l;switch(this.el.tagName){case"IMG":case"IFRAME":case"VIDEO":case"SCRIPT":this.el.setAttribute("src",h);break;default:K(this.el,{backgroundImage:"url("+h+")",backgroundRepeat:"no-repeat"})}}c&&this.el.setAttribute("srcset",c),typeof o=="function"&&o(this.el,this.options),this.fire(I.In),this.options.once&&(this.disabled=!0,window.removeEventListener("scroll",this.eventHandler),window.removeEventListener("resize",this.dCalcBounds)),this.added=!0},e.outOfView=function(){var s=this.options,i=s.className,o=s.outOfView;i&&this.el.classList&&b(this.el,i),typeof o=="function"&&o(this.el,this.options),this.fire(I.Out),this.added=!1},e.fire=function(s){v(this.el,s,{detail:{instance:this,options:this.options}})},e.onScroll=function(){var s=n.getScrollY();if(!(this.paused||this.disabled)){if(this.options.progress){var i=s/(document.documentElement.scrollHeight-window.innerHeight);this.el.style.width=i*100+"%"}if(s<this.start||this.end&&s>this.end){this.added&&this.outOfView();return}this.added||this.inView()}},n.checkElement=function(s,i,o){if(!s)throw new Error(i+` element doesn't match any element with selector: "`+o+'"')},n.getScrollY=function(){return window.pageYOffset||document.documentElement.scrollTop},n.processPosition=function(s,i){return s==="top"||(s==="middle"?i-=window.innerHeight/2:s==="bottom"?i-=window.innerHeight:i-=window.innerHeight*(parseInt(s,10)/100)),i},n}(),U=function(e){var t=[];if(e&&Array.isArray(e))e.forEach(function(i){var o=u(i.el);if(o===null)throw new Error("unknown element");o.forEach(function(r){delete i.el,t.push(new Z(r,i))})});else{if(e)throw new Error("please convert object to array");var s=u("[data-scroll]");s.forEach(function(i){var o=q("scroll",i);o.progress!==null&&typeof o.progress<"u"&&(o.progress=!0),o.className=o.class,o.offset&&(o.offset=parseInt(o.offset,10)),typeof o.once<"u"&&(o.once=!0),t.push(new Z(i,o))})}return t};document.readyState!=="complete"&&document.addEventListener("readystatechange",function(){document.readyState==="complete"&&v(window,"resize")});C(U);U.Events=I;U.ScrollTrigger=Z;var V=U;function ee(){return ee=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)({}).hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ee.apply(null,arguments)}function rt(n){var e=function(t){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var i=s.call(t,"string");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n);return typeof e=="symbol"?e:e+""}function te(n,e){return e===void 0&&(e="module"),n.parentElement?n.parentElement.dataset[e]?n.parentElement:te(n.parentElement):n}var He="[data-action]",R={find:u,findOne:S,on:f},a=function(){function n(i,o){var r=this;return this.el=void 0,this.options=void 0,this.moduleName=void 0,this.els=void 0,this.setUps=void 0,this.id=void 0,this.actionRouter=function(l){var c=l.currentTarget,h=n.parseAction(c).name,p=q("action",c);h&&r[h].call(r,c,l,p)},this.log("Beginning setup"),this.el=i,this.options=ee({},this.defaults,q("module",this.el)),this.moduleName=o||this.el.dataset.module||"",this.els={},this.setUps={},this.id="",this.preInit(),this.generateUuid(),this.storeRef(),this.setupActions(),this.setupNamed(),this.verifyRequired(),this.postInit(),this.log("Initalized"),this}var e,t,s=n.prototype;return s.preInit=function(){this.log("No preInit() actions included.")},s.postInit=function(){this.log("No postInit() actions included.")},s.generateUuid=function(){this.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var o=16*Math.random()|0;return(i==="x"?o:3&o|8).toString(16)})},s.storeRef=function(){if(window.domorefs===void 0&&(window.domorefs={}),window.domorefs[this.el.dataset.moduleUid||"undefined"])return!1;this.el.dataset.moduleUid=this.id,window.domorefs[this.el.dataset.moduleUid]=this},s.setupActions=function(){var i=this;this.setupAction(this.el),this.find(He).forEach(function(o){te(o)===i.el&&i.setupAction(o)})},s.setupAction=function(i){if(i.dataset.domoduleActionProcessed!=="true"){var o=n.parseAction(i),r=o.name,l=o.type;r&&(typeof this[r]=="function"?(this.log(r+" bound"),this.storeSetUp(r,"actions"),R.on(i,l,this.actionRouter),i.dataset.domoduleActionProcessed="true"):this.log(r+" was registered, but there is no function set up"))}},s.setupNamed=function(){var i=this;this.find("[data-name]").forEach(function(o){if(o.dataset.name){var r=o.dataset.name;te(o)===i.el&&(o.dataset.domoduleNameProcessed||(i.els[r]?Array.isArray(i.els[r])?i.els[r].push(o):i.els[r]=[i.els[r],o]:i.els[r]=o,i.storeSetUp(o.dataset.name,"named"),o.dataset.domoduleNameProcessed="true",o.dataset.domoduleOwner=i.id))}})},s.storeSetUp=function(i,o){this.setUps[o]===void 0&&(this.setUps[o]=[]),this.setUps[o].indexOf(i)<0&&this.setUps[o].push(i)},s.verifyRequired=function(){var i,o=this;return(i=this.required)!=null&&(i=i.options)!=null&&i.length&&(this.setUps.options=Object.keys(this.options)),Object.keys(this.required).forEach(function(r){o.required[r].forEach(function(l){if(o.setUps[r].indexOf(l)<0)throw new Error(l+" is required as "+r+" for "+o.moduleName+", but is missing!")})}),this},s.find=function(i){return R.find(i,this.el)},s.findOne=function(i){return R.findOne(i,this.el)},s.findByName=function(i){return this.els[i]},s.getOption=function(i){return this.options[i]},s.destroy=function(){var i,o=this;R.find(He,(i=this.el.parentElement)!=null?i:void 0).forEach(function(r){if(r.dataset.domoduleActionProcessed==="true"){var l=n.parseAction(r);r.removeEventListener(l.type,o.actionRouter),r.dataset.domoduleActionProcessed="false"}})},s.log=function(i){n.log(this.constructor.name+": "+i)},s.error=function(i){n.error(this.constructor.name+": "+i)},n.parseAction=function(i){var o;return{name:i.dataset.action,type:(o=i.dataset.actionType)!=null?o:"click"}},n.getInstance=function(i){return i.dataset.moduleUid&&window.domorefs?window.domorefs[i.dataset.moduleUid]:(n.log("The dataset of "+(i.getAttribute("id")||"NO ID")+" has no UID."),!1)},n.register=function(i,o){if(typeof i!="string")i=(o=i).prototype.constructor.name;else if(typeof i=="string"&&o===void 0)throw new Error("No Domodule class instance was provided in either parameter.");window.domodules||(window.domodules={}),n.log("Registering "+i),window.domodules[i]=o},n.discover=function(i){if(i===void 0&&(i="body"),n.log("Discovering modules..."),window.domodules){var o;o=i instanceof Element?[i]:Array.isArray(i)?i:R.find(i);var r=[];return o.forEach(function(l){R.find("[data-module]",l).forEach(function(c){var h=c.dataset.module;if(h&&window.domodules&&typeof window.domodules[h]=="function"){if(typeof window.domorefs=="object"&&c.dataset.moduleUid&&window.domorefs[c.dataset.moduleUid]!==void 0)return;n.log(h+" found");var p=window.domodules[h];r.push(new p(c))}})}),r}n.log("No modules found")},n.log=function(i){n.debug&&console.log("[DOMODULE] "+i)},n.error=function(i){console.error("[DOMODULE] "+i)},e=n,(t=[{key:"required",get:function(){return{}}},{key:"defaults",get:function(){return{}}}])&&function(i,o){for(var r=0;r<o.length;r++){var l=o[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(i,rt(l.key),l)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}();a.autoDiscover=void 0,a.debug=void 0,a.debug=typeof window.localStorage=="object"&&window.localStorage.getItem("DomoduleDebug"),a.autoDiscover=!0,window.addEventListener("DOMContentLoaded",function(){a.autoDiscover&&a.discover()});function Ge(n,e){for(var t=0;t<e.length;t++){var s=e[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function at(n,e,t){return e&&Ge(n.prototype,e),t&&Ge(n,t),n}function lt(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var T={facebook:"https://www.facebook.com/sharer/sharer.php",linkedin:"https://www.linkedin.com/shareArticle",pinterest:"https://pinterest.com/pin/create/button",reddit:"https://reddit.com/submit",twitter:"https://twitter.com/intent/tweet",bluesky:"https://bsky.app/intent/compose",whatsapp:"https://api.whatsapp.com/send"},ct=function(n){lt(e,n);function e(){return n.apply(this,arguments)||this}var t=e.prototype;return t.postInit=function(){var i=this,o=this.options.net+"Setup",r=this.options.net+"Share";if(!this[r]&&!this[o])throw new Error("Sharing method for "+this.options.net+" is not implemented");this[o]&&this[o](),this[r]&&f(this.el,"click",function(l){l.preventDefault(),i[r]()})},t.getShareUrl=function(){var i=window.location.href;return this.options.baseUrl&&(this.options.relative?i=""+window.location.origin+window.location.pathname+this.options.baseUrl:i=this.options.baseUrl),i},t.twitterShare=function(){e.openWindow(this.el.href,"260","500","twitterWindow")},t.blueSkyShare=function(){e.openWindow(this.el.href,"260","500","blueskyWindow")},t.linkedinShare=function(){e.openWindow(this.el.href,"520","570","linkedinWindow")},t.pinterestShare=function(){e.openWindow(this.el.href,"600","600","pinterestWindow")},t.redditShare=function(){e.openWindow(this.el.href,"600","600","redditWindow")},t.whatsappShare=function(){e.openWindow(this.el.href,"550","400","whatsappWindow")},t.facebookShare=function(){if(typeof window.FB<"u"&&typeof window.FB.ui<"u"){var i={method:"share",href:this.getShareUrl()};this.options.tag&&(i.hashtag="#"+this.options.tag),this.options.text&&(i.quote=this.options.text),FB.ui(i)}else e.openWindow(this.el.href,"440","600","facebookWindow")},t.facebookSetup=function(){var i=["u="+this.getShareUrl()];this.options.tag&&i.push("hashtag="+encodeURIComponent("#"+this.options.tag)),this.options.text&&i.push("quote="+encodeURIComponent(this.options.text)),this.el.href=T.facebook+"?"+i.join("&")},t.emailSetup=function(){var i=encodeURIComponent(this.options.subject||document.title),o=this.options.body||"Check this out #url";o=o.replace(/#url/gi,this.getShareUrl()),o=encodeURIComponent(o),this.el.href="mailto:?subject="+i+"&body="+o},t.linkedinSetup=function(){this.el.href=T.linkedin+"?mini=true&url="+encodeURIComponent(this.getShareUrl())},t.twitterSetup=function(){var i=this.options.text||e.getMeta("text","twi"),o=this.options.tags||e.getMeta("hashtag","twi"),r=this.options.via||e.getMeta("author","twi"),l=this.options.image||e.getMeta("image","twi"),c=[];c.push("url="+encodeURIComponent(this.getShareUrl())),i&&c.push("text="+encodeURIComponent(i)),o&&o!=="none"&&c.push("hashtags="+encodeURIComponent(o)),r&&r!=="none"&&c.push("via="+encodeURIComponent(r)),l&&c.push("media="+encodeURIComponent(l)),this.el.href=T.twitter+"?"+c.join("&")},t.blueskySetup=function(){var i=this.options.text||e.getMeta("text","twi"),o=[],r=i+`
`+this.getShareUrl();i&&o.push("text="+encodeURIComponent(r)),this.el.href=T.bluesky+"?"+o.join("&")},t.pinterestSetup=function(){var i=this.options.title||e.getMeta("title"),o=this.options.media||e.getMeta("image"),r=["url="+encodeURIComponent(this.getShareUrl())];i&&r.push("description="+encodeURIComponent(i)),o&&r.push("media="+encodeURIComponent(o)),this.el.href=T.pinterest+"?"+r.join("&")},t.redditSetup=function(){var i=this.options.title,o=["url="+encodeURIComponent(this.getShareUrl())];i&&o.push("title="+encodeURIComponent(i)),this.el.href=T.reddit+"?"+o.join("&")},t.whatsappSetup=function(){var i=this.options.text||e.getMeta("text"),o=[];i&&o.push("text="+encodeURIComponent(i)),this.el.href=T.whatsapp+"?"+o.join("&")},e.getMeta=function(i,o){o===void 0&&(o="og");var r=S('meta[property="'+o+":"+i+'"]');return r?r.getAttribute("content"):null},e.openWindow=function(i,o,r,l){window.open(i,l,"menubar=no,toolbar=no,left=200,top=200,resizable=yes,scrollbars=no,height="+o+",width="+r)},at(e,[{key:"required",get:function(){return{options:["net"]}}},{key:"defaults",get:function(){return{relative:!1,baseUrl:!1}}}]),e}(a);a.register("SocialShareButton",ct);function H(n,e,t,s,i,o,r){t===void 0&&(t=null),s===void 0&&(s="/"),i===void 0&&(i=null),o===void 0&&(o=!1),r===void 0&&(r="Strict");var l=new Date,c=typeof e,h="",p="",m="",y="",A="";t&&(l.setTime(l.getTime()+t*24*60*60*1e3),h="; expires="+l.toUTCString()),c==="object"&&c!=="undefined"?p=encodeURIComponent(JSON.stringify({value:e})):p=encodeURIComponent(e),r&&(A="; SameSite="+r,r.toLowerCase()==="none"&&(o=!0)),o&&(m="; secure"),i&&(y="; domain="+encodeURIComponent(i));var B=n.trim().replace(/\s+/g,"-").replace(/[^a-z0-9_-]/gi,"");if(B)document.cookie=B+"="+p+h+"; path="+s+m+y+A;else throw new Error("Invalid cookie name, only alphanumeric values, '-' and '_' are accepted")}function ie(n){var e=n+"=",t=document.cookie.split(";"),s=null;return t.forEach(function(i){var o=i.trim();if(o.indexOf(e)===0){if(s=decodeURIComponent(o.substring(e.length,o.length)),s.substring(0,1)==="{")try{s=JSON.parse(s),s=s.value||null}catch{return}s==="undefined"&&(s=void 0)}}),s}function dt(n){H(n,"",-1)}function ht(n,e){var t=ie(n)||0;H(n,~~t+1,e)}function ut(n,e){var t=ie(n)||0;H(n,~~t-1,e)}var ft={set:H,get:ie,remove:dt,increment:ht,decrement:ut},D=ft;var je=1e3,pt=function(){function n(t,s){s===void 0&&(s=7),this.expires=s||7,this.key="diceroll-"+t,this.cookieValue=D.get(this.key)||!1,this.tests=[]}var e=n.prototype;return e.test=function(s,i){return this.tests.push({percentage:s,callback:i}),this},e.otherwise=function(s){return this.elseCallback=s,this},e.setCookie=function(s){D.set(this.key,s.toString(),this.expires)},e.run=function(){for(var s=Math.floor(Math.random()*je+1),i=this.tests.length,o=0,r=0,l,c;r<i;r++){var h=this.tests[r];if(this.cookieValue?r.toString()===this.cookieValue&&(c=!0,h.callback(h.percentage,r)):(l=h.percentage/100*je,s>=o&&s<=o+l?(this.setCookie(r),h.callback(h.percentage,r),c=!0):c=!1,o+=l+1),c)return}c||this.elseCallback&&(this.setCookie(r),this.elseCallback(!1,r.toString()))},n}();function mt(n,e){return new pt(n,e)}var Fe=mt;function O(n){let e="_ti_user_properties_data",t=".theintercept.com",i=gt(e),o={};if(i)try{o=JSON.parse(decodeURIComponent(i))}catch(l){console.error("Error parsing existing cookie:",l)}"subscribed"in n&&(o.subscribed=!!n.subscribed),"variant"in n&&(o.variant=String(n.variant)),"case"in n&&(o.case=String(n.case));try{o.visitorId=PARSELY.visitorManager.getVisitorInfo().id}catch{}let r=encodeURIComponent(JSON.stringify(o));document.cookie=`${e}=${r}; domain=${t}; path=/; max-age=31536000; secure; samesite=strict`}function gt(n){let t=`; ${document.cookie}`.split(`; ${n}=`);if(t.length===2)return t.pop().split(";").shift()}var se=class extends a{postInit(){this.store=window._abStore_=window._abStore_||{},this.safeName=this.options.name.replace(/[^a-z0-9_]/gi,"-"),typeof this.store[this.options.name]>"u"&&this.logImpression();let e=this.find("[data-variant]");this.value=this.store[this.options.name].value,this.variant=this.store[this.options.name].variant,this.source=this.store[this.options.name].source,e.forEach(t=>{t.dataset.variant!==this.slug&&(t.hidden=!0)}),requestAnimationFrame(()=>{this.onVariantSelected(),this.el.classList.add("ab-running")}),this.el.addEventListener("conversion",this.onClick.bind(this)),this.el.addEventListener("impression",()=>{this.track("impression")})}onVariantSelected(){v(this.el,"variantSelected")}onClick(){this.track("conversion")}logImpression(){let e=parseInt(this.options.variants,10),t=Fe(this.safeName,1);for(let s=0;s<e;s++){let i=parseInt(this.options["variantPercent-"+s],10),o=this.options["variantValue-"+s],r=this.options["variant-"+s];t.test(i,()=>{this.store[this.options.name]={logged:!0,variant:s,value:o,slug:r,source:`web_intercept_${this.options.date}_${encodeURIComponent(this.options.name)}_${encodeURIComponent(r)}`},this.value=o,this.variant=s,this.slug=r,this.source=`web_intercept_${this.options.date}_${encodeURIComponent(this.options.name)}_${encodeURIComponent(r)}`})}t.run()}track(e){O({variant:this.slug,case:this.options.name}),window._GATrack_.sendEvent("ab","case",e,()=>{},1e3,{variant:this.slug,case:this.options.name})}};a.register("ABTesting",se);var ne=class extends a{postInit(){this.el.id&&(document.body.addEventListener("click",this.handleClick.bind(this)),this.expanded=!1)}handleClick(e){let t=e.target,s=`[aria-controls="${this.el.id}"]`,i=t.closest(s);i&&(e.preventDefault(),this.toggle(i))}toggle(e){this.expanded=!this.expanded;let t=e.querySelector("[data-text-holder]");e.setAttribute("aria-expanded",this.expanded),this.el.setAttribute("aria-hidden",!this.expanded),t&&(t.textContent=this.expanded?e.dataset.expandText:e.dataset.collapseText),this.el.addEventListener("transitionend",()=>{this.el.removeAttribute("style"),this.el.classList.toggle("h-0",!this.expanded)},{once:!0});let s=this.el.firstElementChild.offsetHeight;this.el.style.height=`${s}px`,this.expanded||requestAnimationFrame(()=>{this.el.style.height="0px"})}};a.register("Accordion",ne);var G=function(){var n=[].slice.call(arguments);return n.unshift(!1),We.apply(null,n)};function We(){var n=[].slice.call(arguments),e=n[0],t={};return n.slice(1,n.length).forEach(function(s){Object.keys(s).forEach(function(i){if(!e||n[1][i]!==void 0){var o=s[i];t[i]=Array.isArray(o)||typeof o!="object"||typeof t[i]!="object"?o:(e?G.defaults:G)(t[i],o)}})}),t}G.defaults=function(){var n=[].slice.call(arguments);return n.unshift(!0),We.apply(null,n)};var $e=G;var d={sendEvent:function(e,t,s,i,o){i===void 0&&(i=null),o===void 0&&(o=1e3),d.prefix&&(e=d.prefix+"-"+e);var r=function(){};if(d.log(e,t,s),!d.isEnabled)return typeof i=="function"&&i(),d;if(typeof i=="function"){var l;r=function(){l&&(clearTimeout(l),l=null,i())},l=setTimeout(r,o)}if(d.isGAQ)_gaq.push(["_trackEvent",e,t,s,null,!1]),_gaq.push(r);else if(d.isGTag){var c={event_category:e,event_label:s,event_callback:r};d.sendData("event",t,c)}else if(d.isGA){var h={transport:"beacon",hitCallback:r};d.sendData("send","event",e,t,s,h)}},send:function(){var e=Array.prototype.slice.call(arguments);d.isGA&&e.unshift("send"),d.sendData.apply(null,e)},sendData:function(){if(!d.isEnabled)return d;var e=Array.prototype.slice.call(arguments);d.isGTag?gtag.apply(null,e):d.isGA&&(d.trackerName&&(e[0]=d.trackerName+"."+e[0]),ga.apply(null,e))},getData:function(e,t){t===void 0&&(t={});var s=e.dataset.gaTrackHref||e.getAttribute("href"),i=e.dataset.gaTrack||t.category||"ga-track",o=e.dataset.gaTrackLabel||t.label||s,r=e.dataset.gaTrackAction||t.action||e.textContent.trim();return{href:s,category:i,label:o,action:r}},track:function(e,t){if(t===void 0&&(t={}),Array.isArray(e)){e.forEach(function(s){u(s.element).forEach(function(i){d.track(i,s)})});return}typeof e.dataset.gaTrackInitialised<"u"||(e.dataset.gaTrackInitialised="true",t=$e({},d.defaults,t),this.log("tracking",e,t),f(e,"click",function(s){d.onTrackedClick(e,s,t)}))},onTrackedClick:function(e,t,s){var i=d.getData(e,s),o=e.getAttribute("target"),r=null;e.dataset.gaTrackHref==="false"?t.preventDefault():i.href&&!t.metaKey&&t.which===1&&o!=="_blank"&&(t.preventDefault(),r=function(){window.location=i.href});try{d.sendEvent(i.category,i.action,i.label,r,s.timeout)}catch{typeof r=="function"&&r()}},autotrack:function(){if(d.autotracking!==!0){d.autotracking=!0;var e="[data-ga-track]";f(document.body,"click",function(t){var s=t.target;J(s,e)||(s=Be(s,e)),s&&d.onTrackedClick(s,t,d.defaults)})}},log:function(){if(d.debug){for(var e,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];(e=console).log.apply(e,["GATRACK"].concat(s))}},isNullOrEnforced:function(e){return d.force===null||d.force===e},get isGAQ(){return typeof window._gaq<"u"&&d.isNullOrEnforced("gaq")},get isGTag(){return typeof window.gtag<"u"&&d.isNullOrEnforced("gtag")},get isGA(){return typeof window.ga<"u"&&d.isNullOrEnforced("ga")},get isEnabled(){return d.isGA||d.isGTag||d.isGAQ},debug:typeof window.localStorage=="object"&&window.localStorage.getItem("GATrackDebug"),prefix:null,trackerName:"",force:null,defaults:{timeout:1e3}},Ye=function(){return u("[data-ga-track-initialised], [data-ga-track]").map(function(e){return e.style.outline="red dotted 1px",e})};d.debug=window.localStorage.getItem("GATrackDebug");var vt=window.localStorage.getItem("GATrackOutline");window.GAOutlineTracked=Ye;C(function(){window._GATrack_||(window._GATrack_=d,typeof window.gaTrackerName_<"u"&&(d.trackerName=window.gaTrackerName_),d.autotrack(),vt&&Ye())});var wt=(n,e=document.activeElement)=>{let t=Array.from(n.querySelectorAll("a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled])")),s=t[0],i=t[t.length-1],o=null;s.focus(),o=s;let r=l=>{l.preventDefault(),t.includes(l.target)?o=l.target:(o===s?i.focus():s.focus(),o=document.activeElement)};return document.addEventListener("focus",r,!0),{onClose:()=>{document.removeEventListener("focus",r,!0),e.focus()}}},N=null,bt=n=>{if(N&&(n.key==="Escape"||n.key==="Esc")){let e=document.querySelector(".offcanvas__close");e&&e.click()}};f(document.body,"offcanvas:show",()=>{window._GATrack_.sendEvent("navigation-menu","menu-open");let n=document.querySelector(".offcanvas");n&&(n.inert=!1,N=wt(n))});f(document.body,"offcanvas:hide",()=>{window._GATrack_.sendEvent("navigation-menu","menu-close");let n=document.querySelector(".offcanvas");n&&(n.inert=!0,N&&(N.onClose(),N=null))});f(document,"keydown",bt);function w(n){if(document.readyState!=="loading"){n();return}document.addEventListener("DOMContentLoaded",n)}w(()=>{if(!document.body.classList.contains("single-post"))return;let e=document.documentElement.clientHeight||window.innerHeight||0,t=k(()=>{(window.pageYOffset||document.documentElement.scrollTop)>=e&&(window._GATrack_.sendEvent("in_article-body","start reading",location.pathname),window.removeEventListener("scroll",t))},100);window.addEventListener("scroll",t,{passive:!0})});var yt=["/privacy-rights-request/","/consumer-data-request/","/sources"],Et=n=>{let e=n||window.location.pathname;return!yt.includes(e)&&!window.disableTracking},ze=Et;var St=()=>{let n={parsely:{},google:{},...userData_.analytics},[e]=Array.from(document.querySelectorAll('script[type="application/ld+json"]')).filter(t=>!t.className);if(e)try{n.parsely=JSON.parse(e.innerText)}catch{}return n};w(()=>{let n=St();if(setTimeout(()=>{O({})},500),window._GATrack_){ze()||(console.log("not tracking clicks on this url"),Object.defineProperty(window._GATrack_,"isEnabled",{get:()=>!1}));let e=window._GATrack_.sendEvent,t=window._GATrack_.sendData;window._GATrack_.sendData=function(){let s=arguments;s[0]!=="event"&&t.apply(this,s)},window._GATrack_.sendEvent=function(s,i,o,r,l,c){e.call(this,s,i,o,r,l);let p={event:[s,i,o].filter(m=>m&&m!=="undefined"&&m!=="false").join("_").trim()};c&&typeof c=="object"&&Object.keys(c).forEach(m=>{c[m]&&(p[m]=c[m])}),window.dataLayer.push(p)}}});w(()=>{let n=document.querySelectorAll(".animate-highlight"),e=!1;Array.from(n).forEach(t=>{let s=t.parentElement.tagName==="MARK"?t.parentElement:t.firstElementChild;if(!s||s.tagName!=="MARK")return;let i=s.getAttribute("style"),o=s.textContent.trim().length;s.setAttribute("style",`--delay: ${o*12/1e3}s; ${i.replace("background-color:","--current-bg:")}`);let r=t.parentElement.tagName==="MARK"?t.parentElement.parentElement:t.parentElement;r.setAttribute("data-scroll",""),r.setAttribute("data-scroll-once","true"),r.setAttribute("data-scroll-class","in-screen"),r.setAttribute("data-scroll-position","75"),e=!0}),e&&V()});var oe=class extends a{postInit(){Object.entries(this.els).forEach(([e,t])=>{e.startsWith("page-")&&(this.scrollTriggers=window.scrollTriggers([{el:t,position:"top",inView:this.handleInView.bind(this,e)}]))}),this.els.annotationsToggle&&this.els.annotationsToggle.addEventListener("click",this.toggleAnnotations.bind(this))}handleInView(e){window.history.replaceState({},"","#"+e)}toggleAnnotations(){this.els.annotationsToggleText.innerHTML=this.els.annotationsToggleText.innerHTML==="Show annotations"?"Hide annotations":"Show annotations",Object.entries(this.els).forEach(([e,t])=>{e.startsWith("annotation-")&&t.classList.toggle("hidden")})}};a.register("Annotations",oe);var re="social-bar--fixed",ae=class extends a{postInit(){this.mq=window.matchMedia("(min-width: 1200px)"),this.mq.addEventListener("change",this.handleMediaQueryChange.bind(this)),this.isEnabled=this.options.small?!this.mq.matches:this.mq.matches,this.options.offset&&(this.options.offset=parseInt(this.options.offset,10)),this.scrollTriggers=window.scrollTriggers([{el:this.el,position:"top",inView:this.handleInView.bind(this),outOfView:this.handleOutView.bind(this),offset:this.options.offset}])}get defaults(){return{small:!1,offset:0}}handleInView(){this.isEnabled&&this.el.classList.add(re)}handleOutView(){this.isEnabled&&this.el.classList.remove(re)}handleMediaQueryChange(){this.isEnabled=this.options.small?!this.mq.matches:this.mq.matches,this.isEnabled||this.el.classList.remove(re)}};a.register("SocialWrapper",ae);var le=class extends a{postInit(){let e=document.createElement("audio");e.src=this.options.audio,e.type="audio/mp3",e.classList.add("hide"),this.el.appendChild(e),this.audio=e,e.addEventListener("timeupdate",this.updateProgress.bind(this)),e.addEventListener("ended",this.onEnded.bind(this)),e.addEventListener("pause",this.onPause.bind(this)),e.addEventListener("play",this.onPlay.bind(this))}play(){this.audio.paused?this.audio.play():this.audio.pause()}updateProgress(){let e=(100/this.audio.duration*this.audio.currentTime).toFixed(2);e&&this.el.style.setProperty("--value",`${e}%`)}onPause(){this.els.icon.classList.remove("icon-pause"),this.els.icon.classList.add("icon-TI_Play"),this.els.button.setAttribute("aria-label",this.els.button.getAttribute("aria-label").replace("Pause","Play"))}onPlay(){this.els.icon.classList.remove("icon-TI_Play"),this.els.icon.classList.add("icon-pause"),this.els.button.setAttribute("aria-label",this.els.button.getAttribute("aria-label").replace("Play","Pause"))}onEnded(){this.onPause(),this.audio.pause(),this.audio.currentTime=0}};a.register("AudioPullquote",le);var ce=class extends a{postInit(){this.el.innerHTML=this.el.innerHTML.replace(location.host,"theintercept.com")}};a.register("AuthorEmail",ce);var j=(n,e=.5)=>{let t=n.getBoundingClientRect().top,i=(window.innerHeight||document.documentElement.clientHeight)*e;return t<i};var de=class extends a{postInit(){this.titles=u(".shortcode-chapter__title, .chapter-block__title"),this.headings=[],this.links=[],this.activeElement=null,this.titles.length&&this.enable()}enable(){let e=document.createElement("ol");e.classList.add("article-toc__list"),this.titles.forEach(t=>{let s=t.textContent.trim(),i=t.closest("h2"),o="";if(i&&i.id&&(o=i.id,this.headings.push(i)),o&&s){let r=document.createElement("li");r.classList.add("article-toc__item");let l=document.createElement("a");l.classList.add("article-toc__link"),l.href=`#${o}`,l.textContent=s,r.appendChild(l),e.appendChild(r),this.links.push({link:l,heading:i})}}),this.headings.length&&(this.el.firstElementChild.appendChild(e),requestAnimationFrame(()=>{this.el.classList.add("active")}),window.addEventListener("scroll",this.onScroll.bind(this),{passive:!0}),this.el.addEventListener("click",t=>{(t.target.classList.contains("article-toc__link")||t.target.closest(".article-toc__link"))&&this.el.classList.remove("expanded")}))}onScroll(){for(let e=0;e<this.links.length;e++){let{heading:t,link:s}=this.links[e];j(t)&&this.setInView(s)}}setInView(e){e!==this.activeElement&&this.activeElement&&this.activeElement.classList.remove("active"),e.classList.add("active"),this.activeElement=e}toggle(){this.el.classList.toggle("expanded")}};a.register("ChapterTOC",de);var he=class extends a{postInit(){this.handleScroll(),window.addEventListener("scroll",this.handleScroll.bind(this))}handleScroll(){window.scrollY>=this.options.transitionHeight?this.el.classList.add("column-header--scrolled"):this.el.classList.remove("column-header--scrolled")}};a.register("ColumnistHeader",he);var ue=class extends a{postInit(){this.els.prevPage.addEventListener("click",e=>{let t=Math.max(parseInt(this.els.selectPage.value)-1,1);this.els.selectPage.value=t,this.els.currentPage.innerHTML=t,this.scrollToPage(document.getElementById(`page${t}`))}),this.els.nextPage.addEventListener("click",e=>{let t=Math.min(parseInt(this.els.selectPage.value)+1,parseInt(this.els.totalPages.innerHTML));this.els.selectPage.value=t,this.els.currentPage.innerHTML=t,this.scrollToPage(document.getElementById(`page${t}`))}),this.els.selectPage.addEventListener("blur",()=>{let e=Math.min(parseInt(this.els.selectPage.value),parseInt(this.els.totalPages.innerHTML));e>0&&(this.els.selectPage.value=e,this.els.currentPage.innerHTML=e,this.scrollToPage(document.getElementById(`page${e}`)))}),this.els.selectPage.addEventListener("keyup",e=>{e.code==="Enter"&&this.els.selectPage.blur()}),this.els.changeToDocument.addEventListener("click",this.toggleText.bind(this)),this.els.changeToText.addEventListener("click",this.toggleText.bind(this))}toggleText(){this.els.documentWrapper.classList.toggle("show-text"),this.els.changeToDocument.disabled=!this.els.changeToDocument.disabled,this.els.changeToText.disabled=!this.els.changeToText.disabled}scrollToPage(e){window.scroll({behavior:"smooth",left:0,top:e.getBoundingClientRect().top+window.scrollY})}};a.register("Documents",ue);var fe=class extends a{postInit(){if(this.element=document.querySelector(this.options.selector),!this.element)throw new Error(`No element found for selector ${this.options.selector}`);this.calcBounds(),window.addEventListener("resize",k(this.calcBounds.bind(this),100)),window.addEventListener("scroll",this.handleScroll.bind(this),{passive:!0})}calcBounds(){let e=this.element.getBoundingClientRect(),t=this.el.getBoundingClientRect();this.mark=e.bottom-e.y-t.height}handleScroll(){(window.pageYOffset||document.documentElement.scrollTop)>=this.mark?this.el.style.color=this.options.leave:this.el.removeAttribute("style")}};a.register("DynamicColorButton",fe);var Qe="button-visible",pe=class extends a{postInit(){if(this.image=document.body.querySelector(".article-featured-image"),!this.image)return;this.mq=window.matchMedia("(min-width: 1200px)"),this.mq.addEventListener("change",this.handleMediaQueryChange.bind(this)),this.isEnabled=this.mq.matches,new IntersectionObserver(t=>{t.forEach(s=>{!s.isIntersecting&&s.boundingClientRect.bottom<0?this.el.classList.add(Qe):this.el.classList.remove(Qe)})},{root:null,threshold:0}).observe(this.image)}handleMediaQueryChange(){this.isEnabled=this.options.small?!this.mq.matches:this.mq.matches}};a.register("DynamicSupportButton",pe);w(()=>{document.querySelectorAll("a").forEach(n=>{let e=n.host!==window.location.host&&!n.href.includes("theintercept.com"),t=n.href.includes("join.theintercept.com");if(e?n.setAttribute("rel","noreferrer"):t&&n.setAttribute("rel","noopener"),(e||t)&&(n.setAttribute("target","_blank"),n.setAttribute("aria-describedby","targetBlankDescription"),!document.getElementById("targetBlankDescription"))){let s=document.createElement("span");s.id="targetBlankDescription",s.classList.add("screen-reader-text"),s.textContent=" (opens in a new tab)",document.body.appendChild(s)}})});var me=class extends a{postInit(){this.mq=window.matchMedia("(min-width: 1200px)"),this.mq.addEventListener("change",this.handleMediaQueryChange.bind(this)),this.isEnabled=this.options.small?!this.mq.matches:this.mq.matches,this.fixedLogo=S(".fixed-logo-wrapper"),this.normalLogo=S(".sticky-sidebar .logo-wrapper a"),this.shouldFix=this.options.fixed==="true",this.shouldFix&&window.addEventListener("scroll",this.handleScroll.bind(this),{passive:!0}),this.handleMediaQueryChange()}get defaults(){return{small:!1}}handleMediaQueryChange(){this.isEnabled=this.options.small?!this.mq.matches:this.mq.matches,this.isEnabled?(g(this.fixedLogo,"fixed"),b(this.fixedLogo,"hidden"),g(this.normalLogo,"hidden")):(b(this.fixedLogo,"fixed"),g(this.fixedLogo,"hidden"),b(this.normalLogo,"hidden"))}handleScroll(){let e=0,t=window.pageYOffset+130;this.isEnabled&&(e=t-130,e<0&&(e=0));let s=`translate3d(0,${e}px,0)`;this.el.style.transform=s,this.el.style.webkitTransform=s}};a.register("FeaturedImageHero",me);var ge=class extends a{postInit(){this.activeElement=null,this.headings=[],this.height=this.el.offsetHeight,this.showButton=!1,this.isExpanded=!1;let e=this.els.list.querySelectorAll("a");Array.from(e).forEach(t=>{if(t.getAttribute("download"))return;let s=document.querySelector(t.hash);this.headings.push({heading:s,link:t})}),window.addEventListener("scroll",this.onScroll.bind(this),{passive:!0}),document.body.addEventListener("click",this.handleBodyClick.bind(this)),this.onScroll()}handleBodyClick(e){if(this.isExpanded){if(e.target.closest(".site-header__link")){this.toggleExpand();return}e.target.closest(".site-header")||this.toggleExpand()}}onScroll(){let t=(window.scrollY||window.pageYOffset)>=this.height;t!==this.showButton&&(this.showButton=t,this.els.expandButton.setAttribute("aria-hidden",!t));let s=!1;for(let i=0;i<this.headings.length;i++){let{heading:o,link:r}=this.headings[i];j(o)&&(s=r)}s?this.setInView(s):this.activeElement&&(this.activeElement.classList.remove("active"),this.activeElement=null)}toggleExpand(){this.els.expandButton.setAttribute("aria-expanded",!this.isExpanded),this.els.listMobile.setAttribute("aria-hidden",this.isExpanded),this.isExpanded=!this.isExpanded,this.isExpanded?this.els.listMobile.style.height=`${this.els.listMobile.firstElementChild.scrollHeight+2}px`:this.els.listMobile.style.height="0"}setInView(e){e!==this.activeElement&&this.activeElement&&this.activeElement.classList.remove("active"),e.classList.add("active"),this.activeElement=e}};a.register("ImpactReportHeader",ge);var ve=class extends a{postInit(){if(this.container=document.getElementById("postsContainer"),this.scrollTarget=document.getElementById("scroll-target"),!this.container||!this.scrollTarget)return;this.total=this.container.dataset.maxPages,this.categories=this.container.dataset.categories,this.taxonomy=this.container.dataset.taxonomy,this.author=this.container.dataset.author,this.lightMobileBG=this.container.dataset.lightMobileBg,this.hideEyebrow=this.container.dataset.hideEyeBrow,this.nonce=this.container.dataset.nonce,this.count=2;let e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(this.loadArticle(this.count),this.count++,this.count>this.total&&e.unobserve(this.scrollTarget))})});e.observe(this.scrollTarget)}loadArticle(e){this.el.classList.add("infinite-scroll-loading");let t=document.location.origin+"/wp-admin/admin-ajax.php",s=new FormData;s.append("action","load_more_posts"),s.append("nonce",this.nonce),this.author&&s.append("author_name",this.author),e&&s.append("paged",e),this.categories&&s.append("category_ids",this.categories),this.taxonomy&&s.append("taxonomy",this.taxonomy),this.lightMobileBG&&s.append("light_mobile_bg",this.lightMobileBG),this.hideEyebrow&&s.append("hide_eyebrow",this.hideEyebrow),fetch(t,{method:"POST",credentials:"same-origin",body:s}).then(i=>i.text()).then(i=>{this.container.insertAdjacentHTML("beforeend",i),this.container.appendChild(this.scrollTarget),this.el.classList.remove("infinite-scroll-loading")})}};a.register("InfiniteScroll",ve);var we=class extends a{postInit(){this.navButton=document.querySelector(".header__hamburger button"),window.addEventListener("scroll",()=>{let e=this.navButton.getBoundingClientRect().bottom,t=this.el.getBoundingClientRect().bottom+15;e<t?this.navButton.style.color="white":this.navButton.style.color="black"})}};a.register("DefaultSeries",we);var be=class extends a{postInit(){this.videoPlaying=!1,window.addEventListener("scroll",this.handleScroll.bind(this),{passive:!0}),Ue(".content-card__link",e=>{let t=e.currentTarget.querySelector(".content-card__meta");t.style.opacity="0",t.style.height="auto";let s=t.offsetHeight;t.style.height="",t.style.opacity="",requestAnimationFrame(()=>{t.style.height=`${s}px`})},e=>{let t=e.currentTarget.querySelector(".content-card__meta");t.style.height=""})}handleScroll(){!this.videoPlaying&&this.els.video&&this.els.video.play();let e=window.scrollY;this.el.classList.toggle("is-scrolled",e>30)}};a.register("DronePapers",be);var ye=class extends a{postInit(){this.images=this.find("img"),this.toc=u(".microsite-article__title"),this.visibleImage=0,this.mq=window.matchMedia("(min-width: 1200px)"),this.mq.addEventListener("change",this.handleMediaQueryChange.bind(this)),this.isEnabled=this.mq.matches,window.addEventListener("scroll",this.handleScroll.bind(this),{passive:!0})}handleMediaQueryChange(){this.isEnabled=this.mq.matches,this.isEnabled||this.images.forEach((e,t)=>{e.style.opacity=t===0?"1":"0"})}handleScroll(){if(!this.isEnabled)return;let e=document.documentElement.clientHeight||window.innerHeight||0,t=e/8,s=e/3,i=this.visibleImage;this.toc.forEach((o,r)=>{let l=o.getBoundingClientRect().top;l>t&&l<=s&&(i=r)}),i!==this.visibleImage&&this.images[i]&&(this.images[this.visibleImage].style.opacity="0",this.images[i].style.opacity="1",this.visibleImage=i)}};a.register("Kissinger",ye);var Ee=class extends a{get required(){return{options:["category","label"]}}postInit(){this.seen=!1,new IntersectionObserver(s=>{s.forEach(i=>{i.isIntersecting&&(this.seen||(this.seen=!0,this.onView()))})}).observe(this.els.observer||this.el);let t=this.els.articles||this.el;t&&(t.addEventListener("click",this.onClick.bind(this)),t.addEventListener("auxclick",this.onClick.bind(this)))}onView(){window._GATrack_.sendEvent(this.options.category,this.options.label,"seen")}onClick(e){if(!e.target.closest("a")||e.type==="auxclick"&&e.which!==2)return;e.preventDefault();let t=e.target.closest("a").href;window._GATrack_.sendEvent(this.options.category,this.options.label,"click",()=>{e.type==="auxclick"?window.open(t,"_blank"):window.location.href=t})}};a.register("ModuleAnalytics",Ee);var F=class extends a{postInit(){if(this.entryContent=document.querySelector(".entry-content__content"),!this.entryContent)return;this.mq=window.matchMedia("(min-width: 1012px)"),this.offsetMq=window.matchMedia("(min-width: 1200px)"),this.mq.addEventListener("change",this.handleMediaQueryChange.bind(this)),this.offsetMq.addEventListener("change",this.handleOffsetChange.bind(this)),this.barOffset=document.getElementById("wpadminbar")?32:0,this.handleMediaQueryChange();let e=this.entryContent.getBoundingClientRect(),t=this.els.end.getBoundingClientRect();e.bottom<t.top||e.top>t.bottom||(this.scrollTriggers=window.scrollTriggers([{el:this.el,position:"top",inView:this.handleInView.bind(this),outOfView:this.handleOutView.bind(this),offset:this.getOffset()},{el:this.els.end,position:"top",inView:this.handleEndInView.bind(this),outOfView:this.handleEndOutView.bind(this),offset:this.getOffset()}]))}handleOffsetChange(){this.scrollTriggers.forEach(e=>{e.offset=this.getOffset(),e.calcBounds()})}getOffset(){return(this.offsetMq.matches?15+this.barOffset:83+this.barOffset)*-1}handleInView(){this.isEnabled&&this.el.classList.add("most-read--fixed")}handleOutView(){this.isEnabled&&this.el.classList.remove("most-read--fixed")}handleEndInView(){this.isEnabled&&this.el.classList.add("most-read--fixed-end")}handleEndOutView(){this.isEnabled&&this.el.classList.remove("most-read--fixed-end")}handleMediaQueryChange(){if(this.isEnabled=this.mq.matches,this.mq.matches){let e=this.el.firstElementChild;window.getComputedStyle(e).position==="static"&&(this.isEnabled=!1)}this.isEnabled||(this.el.classList.remove("most-read--fixed"),this.el.classList.remove("most-read--fixed-end"))}};a.register("MostRead",F);var Se=class extends a{postInit(){this.el.addEventListener("click",this.handleClick.bind(this))}handleClick(e){let t=e.target.closest("a")||e.target.querySelector("a");t&&window._GATrack_.sendEvent("navigation","menu",this.options.location,()=>{},1e3,{clicked_link:t.textContent.trim()})}};a.register("NavigationMenu",Se);var xe=class extends a{view(){this.els.code.hidden?(this.els.code.hidden=!1,this.els.view.innerText="Hide"):(this.els.code.hidden=!0,this.els.view.innerText="View")}copy(){let e=this.els.code.innerText;try{navigator.clipboard.writeText(e)}catch{this.copyFallback(e)}this.els.copy.innerText="Copied!",setTimeout(()=>{this.els.copy.innerText="Copy"},2e3)}copyFallback(e){let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}};a.register("NewsletterBuilder",xe);var P=n=>async e=>{let t=window.location.origin,s=await fetch(`${t}/newsletter-service${n}`,{body:JSON.stringify(e),headers:{accept:"application/json","content-type":"application/json"},method:"POST"});if(!s.ok&&s.status!==422)throw new Error(s.statusText);let i=await s.json();if(s.status===422)throw new Error(i.error.message);return i};var ke=P("/register");var Ae=P("/subscribe");var xt=P("/verify");var W=class extends a{postInit(){this.privacyEnhanced=window.userData_.privacyEnhanced,this.els.email.addEventListener("keyup",this.handleFormChange.bind(this)),this.options.source===this.defaults.source&&(window.location.pathname==="/"||(this.options.source="web_intercept_20211021_standalone"));let e=new URLSearchParams(window.location.search),t=e.get("source")||e.get("utm_source")||e.get("utm_campaign")||e.get("campaign");t&&(this.options.source=t);let s=!1;this.options.animateSubtitle&&this.options.animateSubtitle.split("").forEach((i,o)=>{s&&(i=" "+i,s=!1),setTimeout(()=>{this.els.subtitle.innerText=this.els.subtitle.innerText+i},20*o),s=i===" "}),!this.privacyEnhanced&&this.els.checkboxWrapper&&this.els.checkboxWrapper.remove(),this.els.checkbox&&this.els.checkbox.addEventListener("change",this.handleFormChange.bind(this))}get defaults(){return{source:"web_intercept_20211021_homepage"}}handleInputFocus(){this.els.form.classList.add("is-expanded"),window._GATrack_.sendEvent("newsletter","article page click",this.options.source)}handleFormChange(){this.els.submit.disabled=!this.els.form.checkValidity()}handleSubmit(e,t){if(t.preventDefault(),this.options.siteKey)try{grecaptcha.ready(()=>{grecaptcha.execute(this.options.siteKey,{action:"submit"}).then(s=>{this.onRecaptchaSuccess(s)})})}catch{this.onRecaptchaSuccess("fake-token")}else this.onRecaptchaSuccess()}onRecaptchaSuccess(e){window._GATrack_.sendEvent("newsletter","newsletter submit",this.options.source);let t={userAgent:window.navigator.userAgent,agreedToPrivacyPolicy:!0,countryCode:window.userData_.countryCode,email:this.els.email.value,lists:["weekly-digest","appeals"],privacyEnhanced:this.privacyEnhanced,realmSpeakingId:"theintercept",referrerUrl:window.userData_.originatingReferrer||window.location.href,source:this.options.source};this.els.phone&&this.els.phone.value&&(t.phone=this.els.phone.value,t.smsOptIn=!1),this.els.smsOptIn&&this.els.smsOptIn.checked&&(t.smsOptIn=!0),e&&(t.token=e),Ae(t,{serviceOrigin:"https://theintercept.com"}).then(s=>{if(s.error)throw new Error(s.error.message);let i={date:Date.now(),subscribed:!0},o={};window._GATrack_.sendEvent("newsletter",`newsletter submit: ${s.status}`,this.options.source);try{if(o=JSON.parse(localStorage.getItem("newsletter")),typeof this.options.conversionId=="string"){try{window.plausible("Newsletter Signup",{props:{location:this.options.conversionId}})}catch{}PARSELY.conversions.trackNewsletterSignup(this.options.conversionId)}}catch(r){console.error(r)}o&&(i={...o,...i}),localStorage.setItem("newsletter",JSON.stringify(i)),this.handleSubscribed()}).catch(s=>{this.els.subtitle?(this.els.title.innerText="Oops!",this.els.subtitle.innerText=s.message):this.els.title.innerText=s.message,this.els.form.remove()})}handleSubscribed(){this.els.form.classList.add("is-subscribed"),this.el.classList.add("is-subscribed"),this.els.title.innerText=this.options.afterTitle,this.els.subtitle&&typeof this.options.afterSubtitle=="string"?this.els.subtitle.innerText=this.options.afterSubtitle:this.els.subtitle.remove()}};a.register("Newsletter",W);var Le=class extends a{get required(){return{named:["scrollTarget","title"],options:["episodesPerPage","show","showType","nonce","archiveHeading"]}}postInit(){this.options.episodesPerPage=parseInt(this.options.episodesPerPage,10),this.template=document.getElementById("episode-template"),this.currentPage=1,this.disabled=!1;let e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(this.currentPage++,this.loadArticles(),this.disabled&&e.unobserve(this.els.scrollTarget))})});e.observe(this.els.scrollTarget)}loadArticles(){let e=document.location.origin+"/wp-admin/admin-ajax.php",t=new FormData;t.append("action","load_more_episodes"),t.append("nonce",this.options.nonce),t.append("show",this.options.show),t.append("per_page",this.options.episodesPerPage),t.append("page",this.currentPage),fetch(e,{method:"POST",credentials:"same-origin",body:t}).then(s=>s.json()).then(s=>{if(!Array.isArray(s)){this.disabled=!0;return}s.length<this.options.episodesPerPage&&(this.disabled=!0),this.appendResults(s)})}appendResults(e){let t=e.reduce((s,i)=>{let o=this.template.content.cloneNode(!0),r=document.createElement("div");if(this.options.showType==="serial"&&i.season!==this.options.archiveHeading){let x=this.els.title.cloneNode(!0);x.innerText=i.season,this.options.archiveHeading=i.season,x.removeAttribute("data-name"),x.removeAttribute("data-domodule-name-processed"),x.removeAttribute("data-domodule-owner"),r.appendChild(x)}r.appendChild(o);let l=i.related_link?"podcast-episode--with-article":"podcast-episode--without-article",c=r.querySelector("article");c.classList.add(l),c.id=i.id;let h=c.querySelector("iframe"),p=c.querySelector(".podcast-episode__title");h.className+=i.source,h.src=i.embed_url,p.innerText=i.title;let m=c.querySelector(".podcast-episode__banner"),y=c.querySelector(".podcast-episode__title-link"),A=c.querySelector(".podcast-episode__credits"),B=c.querySelector(".podcast-episode__excerpt"),qe=c.querySelector(".podcast-episode__author"),Ne=c.querySelector(".podcast-episode__date");if(i.excerpt&&(B.innerHTML=i.excerpt),i.author?qe.innerHTML=i.author:qe.remove(),i.date?Ne.innerHTML=i.date:Ne.remove(),i.related_link)m.href=i.related_link,y.href=i.related_link,A.href=i.related_link,m.innerHTML=i.image;else{m.remove(),y.parentNode.insertBefore(y.firstElementChild,y),y.remove();let x=document.createElement("div");x.className="podcast-episode__credits",x.innerHTML=A.innerHTML,A.parentNode.insertBefore(x,A),A.remove()}return s+r.innerHTML},"");this.el.insertAdjacentHTML("beforeend",t),this.el.appendChild(this.els.scrollTarget)}};a.register("InfiniteEpisodes",Le);var Te=class extends a{postInit(){this.isOpen=!1,document.addEventListener("click",this.handleClick.bind(this))}toggle(){this.isOpen=!this.isOpen,this.els.button.setAttribute("aria-expanded",this.isOpen)}handleClick(e){if(this.isOpen){let t=this.el.contains(e.target),s=e.target.tagName==="A"||!!e.target.closest("a");(!t||s)&&this.toggle()}}};a.register("PodcastLinks",Te);var Je=(n,e)=>{let t=!1;return()=>{t||(n.call(),t=!0,setTimeout(()=>{t=!1},e))}},_e=class extends a{postInit(){this.elements=[].slice.call(this.el.children),this.headings=this.elements.map(e=>document.querySelector(`#${e.getAttribute("data-id")}`)),this.halfScreen=window.innerHeight/2,this.throttledResize=Je(this.handleResize.bind(this),100),this.throttledScroll=Je(this.handleScroll.bind(this),100),window.addEventListener("scroll",this.throttledScroll.bind(this)),window.addEventListener("resize",this.throttledResize.bind(this)),this.handleScroll()}handleScroll(){let e=null;for(let t=0;t<this.headings.length&&this.headings[t].getBoundingClientRect().top<this.halfScreen;t++)e=t;e=e===null?0:e,this.elements.forEach((t,s)=>{s===e?t.classList.remove("opacity-40"):t.classList.add("opacity-40")})}handleResize(){this.halfScreen=window.innerHeight/2,this.handleScroll()}};a.register("PostTOC",_e);var Ke={date:null,subscribed:!1},kt=n=>{if(typeof n=="object"&&n instanceof Date)return n;if(typeof n=="string"){let e=Date.parse(n);if(!isNaN(e))return new Date(e)}},Xe="newsletter",Ze=()=>{try{let n=localStorage.getItem(Xe);if(n)return At(n)}catch(n){console.warn(n)}return{...Ke}},At=n=>{let e=JSON.parse(n||"null");return e?{date:kt(e.date)||null,subscribed:!!e.subscribed}:{...Ke}},Lt=n=>{let{subscribed:e}=n;try{window._GATrack_.sendEvent("set","user","data",()=>{},1e3,{subscribed:String(e)}),O({subscribed:e})}catch{}},Tt=n=>{try{localStorage.setItem(Xe,JSON.stringify(n))}catch(e){console.warn(e)}},$=()=>{let n={date:new Date,subscribed:!0};Tt(n),Lt(n)};var _={LOADING:"loading",ERROR:"is-error",SUCCESS:"success",SIGN_IN:"sign-in",SIGN_UP:"sign-up"};function _t(){window.dataLayer=window.dataLayer||[];let n=window.dataLayer.find(e=>e["gtm.start"]);if(n){if(!n["gtm.uniqueEventId"])return!1}else return!1;return!0}var E=class n extends a{get defaults(){return{visibilityBuster:""}}preInit(){this.sawInPastDay=!!D.get(this.sawInPastDayCookie),this.isPost=document.body.classList.contains("single-post"),this.isHome=document.body.classList.contains("home"),this.isSubscribed=Ze()?.subscribed||!1,this.isSubmitting=!1,this.isPrivacyEnhanced=window.userData_.privacyEnhanced,this.isExcluded=!1,this.ctaLink=this.findOne('a[data-action="onDonate"]');let e=new URL(window.location.href);if(this.options.exclusions)try{let s=JSON.parse(this.options.exclusions);this.isExcluded=s.some(i=>e.pathname===i)}catch{}if(this.isPrivacyEnhanced&&(this.isPrivacyEnhanced=e.searchParams.get("gdpr")!=="false"),this.sawInPastDay&&(this.sawInPastDay=e.searchParams.get("saw_today")!=="false"),this.els.donateCTA){let s=n.getReferrer();if(s){let i=this.els.donateCTA.getAttribute("href"),o=new URL(i);o.searchParams.set("originating_referrer",s),this.els.donateCTA.href=o.toString()}}if(n.isForcedHidden())return;let t=this.el.closest(".ft-ab-test-case");t?t.addEventListener("variantSelected",()=>{setTimeout(()=>{let s=this.el.closest("[data-variant]");this.handleShow(!!s&&!s.hidden)},25)}):setTimeout(()=>this.handleShow(!0),100)}static getReferrer(){return document.referrer||window.userData_.originatingReferrer}static isForcedHidden(){return new URLSearchParams(window.location.search).get("no_popup")==="true"}handleShow(){}afterShow(){D.set(this.sawInPastDayCookie,!0,1)}updateSource(e){if(!this.ctaLink)return;let t=new URL(this.ctaLink.getAttribute("href")),i=`${t.searchParams.get("source")}${e?"-after-sign-in-dollar-amount":"-after-sign-up-dollar-amount"}`;t.searchParams.set("source",i),this.ctaLink.href=t.toString()}handleForm(e,t){if(t.preventDefault(),this.isSubmitting)return;this.isSubmitting=!0,this.els.submit.classList.add(_.LOADING),this.el.classList.remove(_.ERROR),this.els.submit.disabled=!0,this.onBeforeSubmit();let s=window.userData_.countryCode,i=this.els.email.value.trim().toLowerCase(),o=!0,r=!0,l=_t();typeof window.gaGlobal>"u"&&(o=!1),(typeof window.PARSELY>"u"||typeof window.PARSELY.loaded>"u")&&(r=!1),ke({userAgent:window.navigator.userAgent,agreedToPrivacyPolicy:!0,countryCode:s,email:i,lists:["weekly-digest","appeals"],privacyEnhanced:this.isPrivacyEnhanced,realmSpeakingId:"theintercept",referrerUrl:window.location.href,originatingReferrer:document.referrer||window.userData_.originatingReferrer,referrerPostId:window.userData_.referringPostId,source:this.options.source,hasGA:o,hasParse:r,hasTM:l}).then(c=>{if(c.error){this.onError(c.error.message);return}this.el.classList.add(_.SUCCESS),$(new Date);let h=c.status==="verified",p=h?_.SIGN_IN:_.SIGN_UP;this.el.classList.add(p),this.onSuccess(c,i),v(this.el,"newsletter:subscribed"),this.updateSource(h)}).catch(()=>{this.onError("An error occurred. Please try again later.")})}get sawInPastDayCookie(){return[this.moduleName,this.options.visibilityBuster,"sawInPastDay"].filter(Boolean).join("_")}listenToSubscribed(){document.body.addEventListener("newsletter:subscribed",this.onSubscribed.bind(this))}onBeforeSubmit(){}onSubscribed(){}onError(e){this.isSubmitting=!1,this.els.submit.classList.remove(_.LOADING),this.els.submit.disabled=!1,this.el.classList.add(_.ERROR),window._GATrack_.sendEvent("piano_email","signup","error",()=>{},1e3,{reason:`Error: ${e}`}),this.els.error&&(this.els.error.textContent=e)}onSuccess(e){let t=e.status,s={variant:this.options.source},i="confirmed";if(t==="re-registered"){i="reconverted";try{window.plausible("Existing Email Recognized",{props:{location:"Article Wall"}})}catch{}}else if(t==="registered"){i="converted";try{window.plausible("Newsletter Signup",{props:{location:"Article Wall"}})}catch{}}if(["registered","re-registered"].includes(t))try{window.PARSELY.conversions.trackNewsletterSignup("Article Wall")}catch{}e.was_subscribed||window._GATrack_.sendEvent("piano_email","signup","not_subscribed",()=>{},1e3,{...s,reason:e.message}),window._GATrack_.sendEvent("piano_email","signup",i,()=>{},1e3,s),window._GATrack_.sendEvent("piano_direct","donation","seen",()=>{},1e3,{variant:this.options.source})}};var Ce=class extends E{postInit(){this.overlay=document.querySelector(`#${this.moduleName}-overlay`),!this.isPost&&!this.isPrivacyEnhanced&&!this.isSubscribed&&!this.sawInPastDay&&!this.isExcluded&&this.show()}show(){this.el.classList.remove("hidden"),this.afterShow(),this.overlay&&this.overlay.classList.remove("hidden"),window._GATrack_.sendEvent("piano","default","seen",()=>{},1e3,{});try{window.plausible("Experience Seen",{props:{experience:"Default"}})}catch{}}hide(){this.el.classList.add("hidden"),this.overlay&&this.overlay.classList.add("hidden"),window._GATrack_.sendEvent("piano","default","dismissed",()=>{},1e3,{});try{window.plausible("Experience Dismissed",{props:{experience:"Default"}})}catch{}}onSuccess(e){super.onSuccess(e),this.el.classList.remove("default"),this.el.classList.add("subscribed"),window._GATrack_.sendEvent("piano","default","converted",()=>{},1e3,{});try{window.plausible("Donation Intent",{props:{location:"Default"}})}catch{}}};a.register("DefaultExperience",Ce);var Y=class extends E{postInit(){if(this.overlay=document.querySelector(`#${this.moduleName}-overlay`),this.sawInPastDay||E.isForcedHidden())return;let e=this.moduleName==="AggressiveCampaign";this.isSubscribed?this.show():e&&this.isHome&&this.show()}show(){this.el.classList.remove("hidden"),this.overlay&&this.overlay.classList.remove("hidden"),window._GATrack_.sendEvent("piano_direct","donation","seen",()=>{},1e3,{});try{window.plausible("Experience Seen",{props:{experience:"Direct Ask"}})}catch{}this.afterShow()}hide(){this.el.classList.add("hidden"),window._GATrack_.sendEvent("piano_direct","donation","dismissed",()=>{},1e3,{});try{window.plausible("Experience Dismissed",{props:{experience:"Direct Ask"}})}catch{}this.overlay&&this.overlay.classList.add("hidden")}};a.register("DirectAsk",Y);a.register("AggressiveCampaign",Y);var Ie=class n extends a{postInit(){this.periods=Array.isArray(this.els.periods)?this.els.periods:[this.els.periods],this.amounts=Array.isArray(this.els.amounts)?this.els.amounts:[this.els.amounts],this.el.addEventListener("submit",n.handleFormSubmit),this.updateSource()}getPeriod(){let e=this.periods.filter(t=>t.checked);if(e.length)return e[0].value}getAmount(){let e=this.amounts.find(t=>t.classList.contains("hidden")===!1);if(e){let t=e.querySelector("input:checked");if(t)return t.value}}updateSource(){let e=this.getPeriod(),t=this.getAmount(),s=new URL(this.els.cta.getAttribute("href"));s.searchParams.set("recurring_period",e),s.searchParams.set("amount",t);let i=document.referrer||window.userData_.originatingReferrer;i&&s.searchParams.set("originating_referrer",i),this.els.cta.href=s.toString()}updatePeriod(){let e=this.getPeriod();b(this.amounts,"hidden"),g(this.amounts.filter(t=>t.dataset.period!==e),"hidden"),this.updateSource()}onDonate(){v(this.el,"conversion"),window._GATrack_.sendEvent(this.options.type,"donation","click",()=>{},1e3,{variant:this.options.source}),window._GATrack_.sendEvent(this.options.type,"donation","amount",()=>{},1e3,{value:this.getAmount(),variant:this.options.source}),window._GATrack_.sendEvent(this.options.type,"donation","frequency",()=>{},1e3,{value:this.getPeriod(),variant:this.options.source});try{let e="";switch(this.options.type){case"piano_direct":e="Direct Ask";break;case"eoa":e="End of Article";break;case"inline-wall":e="Donation Wall";break;default:e="Donation Promo"}window.plausible("Donation Intent",{props:{period:this.getPeriod(),amount:this.getAmount(),location:e}})}catch{}}static handleFormSubmit(e){e.preventDefault()}};a.register("Donation",Ie);var Re=class extends a{postInit(){let e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(this.trackEvent(),e.disconnect())})});e.observe(this.el)}trackEvent(){v(this.el,"impression"),window._GATrack_.sendEvent("end_of_article","donation","seen",()=>{},1e3,{variant:this.options.source});try{window.plausible("Experience Seen",{props:{experience:"End Of Article"}})}catch{}}};a.register("EndOfArticle",Re);var De=class extends E{postInit(){if(this.isPrivacyEnhanced)this.els.fallback.classList.remove("hidden");else if(this.isSubscribed){this.els.subscribed.classList.remove("hidden");let e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(this.trackEvent(),e.disconnect())})});e.observe(this.el)}else this.els.unsubscribed.classList.remove("hidden");this.listenToSubscribed()}trackEvent(){window._GATrack_.sendEvent("inline_newsletter","donation","seen",()=>{},1e3,{variant:this.options.source});try{window.plausible("Experience Seen",{props:{experience:"Inline Newsletter"}})}catch{}}handleDonate(){window._GATrack_.sendEvent("inline_newsletter","donation","converted",()=>{},1e3,{variant:this.options.source});try{window.plausible("Donation Intent",{props:{location:"Inline Newsletter"}})}catch{}}onSubscribed(){this.isPrivacyEnhanced||(this.els.subscribed.classList.remove("hidden"),this.els.unsubscribed.classList.add("hidden"))}};a.register("InlineNewsletter",De);var M={INVISIBLE:"invisible",FULL_SCREEN:"meter-expired--full-screen",METER_EXPIRED:"meter-expired"},Ct=2*60*60*1e3,Oe=class extends E{get required(){return{options:["source"],named:["email","submit"]}}postInit(){this.entryContent=document.querySelector(".entry-content"),this.isSubmitting=!1}getTimeSincePostDate(){let e=new Date,t=new Date(this.options.postDate);return e-t}handleShow(e){let t=this.getTimeSincePostDate(),s=!1,i=e&&this.isPost&&!this.isPrivacyEnhanced&&!this.isSubscribed;if(this.options.noWallBeforeTwoHours){let o=t>=Ct,r=document.body.querySelector(".post"),l="";r&&(l=r.id.replace("post-","")),gtag("event","view_article",{paywall_status:o?"open":"closed",article_id:l,article_publish_timestamp:this.options.postDate,time_since_publish:Math.floor(t/60)}),o||(s=!0)}i&&!s?this.show():(this.el.remove(),this.destroy())}show(){this.el.classList.remove(M.INVISIBLE),this.afterShow(),window._GATrack_.sendEvent("piano_email","signup","seen",()=>{},1e3,{variant:this.options.source});try{window.plausible("Experience Seen",{props:{experience:"Article Wall"}})}catch{}}afterShow(){super.afterShow(),document.body.classList.add(M.FULL_SCREEN),this.entryContent&&this.entryContent.classList.add(M.METER_EXPIRED)}onTermsClick(e,t){t.target.closest("a")&&window._GATrack_.sendEvent("piano_email","signup","tos",()=>{},1e3,{variant:this.options.source})}hide(){this.el.classList.add(M.INVISIBLE),document.body.classList.remove(M.FULL_SCREEN),window._GATrack_.sendEvent("piano_direct","donation","dismissed",()=>{},1e3,{variant:this.options.source});try{window.plausible("Experience Dismissed",{props:{experience:"Article Wall"}})}catch{}this.entryContent&&this.entryContent.classList.remove(M.METER_EXPIRED)}};a.register("InlineWall",Oe);w(()=>{try{new URLSearchParams(window.location.search).get("utm_medium")==="email"&&$()}catch(e){console.error(e)}let n=Array.from(document.querySelectorAll(".need-originating-referrer"));if(n.length){let e=document.referrer||window.userData_.originatingReferrer;n.forEach(t=>{if(t.tagName!=="A")return;let s=new URL(t.getAttribute("href"));s.searchParams.get("originating_referrer")||(s.searchParams.set("originating_referrer",e),t.href=s.toString())})}});var Pe=class extends a{postInit(){this.supportsNavigatorShare="share"in navigator,this.isMediaSupported()?this.els.button.setAttribute("aria-label","Share this page"):(this.els.button.setAttribute("aria-label","Share this page on social media"),this.els.button.setAttribute("aria-expanded","false"),this.els.button.setAttribute("aria-haspopup","true"),this.els.button.setAttribute("aria-controls",this.els.menu.id),this.els.menu.setAttribute("role","menu"),this.els.menu.setAttribute("aria-labelledby",this.els.button.id),this.els.menu.setAttribute("aria-hidden","true")),document.body.addEventListener("click",this.handleBodyClick.bind(this)),this.el.addEventListener("mouseenter",this.openMenu.bind(this)),this.el.addEventListener("mouseleave",this.closeMenu.bind(this))}copyToClipboard(){try{navigator.clipboard.writeText(window.location.href)}catch{let t=document.createElement("textarea");t.value=window.location.href,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}handleBodyClick(e){if(this.els.menu.contains(e.target)){(e.target.closest("a")||e.target.closest("button"))&&this.closeMenu();return}this.el.contains(e.target)||this.closeMenu()}click(){if(this.isMediaSupported()){try{window._GATrack_.sendEvent("share_social","native_mobile_share")}catch{}return navigator.share({title:this.options.text,url:window.location.href})}else this.toggleMenu()}toggleMenu(){let e=this.els.menu.getAttribute("aria-hidden")==="false";this.els.menu.setAttribute("aria-hidden",e),this.els.button.setAttribute("aria-expanded",!e)}closeMenu(){let e=this.els.menu.getAttribute("aria-hidden")==="false";!this.isMediaSupported()&&e&&(this.els.menu.setAttribute("aria-hidden","true"),this.els.button.setAttribute("aria-expanded","false"))}openMenu(){this.isMediaSupported()||(this.els.menu.setAttribute("aria-hidden","false"),this.els.button.setAttribute("aria-expanded","true"))}isMediaSupported(){return this.supportsNavigatorShare&&window.matchMedia("(max-width: 1023px)").matches}};a.register("Share",Pe);var Me=class extends a{postInit(){if(this.headings=[...this.els.staticContent.querySelectorAll("h2")].filter(e=>!e.hasAttribute("data-prevent-toc")),this.headings.length>0){let e=document.createElement("ul");this.scrollPosition=window.pageYOffset||document.documentElement.scrollTop,this.headings=this.headings.map((t,s)=>{let i={el:t,text:t.id||t.textContent,id:t.id||t.textContent.split(" ").join("").toLowerCase(),item:document.createElement("li"),link:document.createElement("a"),position:t.getBoundingClientRect().top+this.scrollPosition};return i.el.id=i.id.trim(),i.link.href="#"+i.id.trim(),i.link.textContent=i.text.trim().replace(/-/g," "),i.item.appendChild(i.link),e.appendChild(i.item),i.link.addEventListener("click",o=>{o.preventDefault(),window.scrollTo({top:i.position,behavior:"smooth"})}),i}),this.updateTOC(),window.addEventListener("scroll",this.updateTOC.bind(this)),this.els.staticTOC.appendChild(e)}}updateTOC(){let e=0;this.scrollPosition=(window.pageYOffset||document.documentElement.scrollTop)+40,this.headings.forEach((t,s)=>{this.scrollPosition>t.position&&(e=s)}),this.headings[e].link!==this.activeLink&&(this.activeLink&&this.activeLink.classList.remove("active"),this.headings[e].link.classList.add("active"),this.activeLink=this.headings[e].link)}};a.register("TableOfContents",Me);w(()=>{u("[data-tooltip]").forEach(t=>{t.tagName!=="A"&&(t.tabIndex=0);let s=t.getAttribute("data-tooltip");t.setAttribute("aria-label",s)});let e;document.body.addEventListener("click",t=>{let s=t.target.closest("[data-tooltip]");if(!s){e&&(e.classList.remove("is-active"),setTimeout(()=>{e.remove(),e=null},400));return}if(t.preventDefault(),e){e.firstElementChild.textContent=s.getAttribute("data-tooltip");return}e=document.createElement("div"),e.classList.add("js-tooltip-content");let i=document.createElement("div");i.textContent=s.getAttribute("data-tooltip");let o=document.createElement("button");o.classList.add("js-tooltip-close"),o.setAttribute("aria-label","Close tooltip"),e.appendChild(i),e.appendChild(o),document.body.appendChild(e),requestAnimationFrame(()=>{e.classList.add("is-active")})})});var z=()=>{if(!window.CSS||!window.CSS.supports("color","var(--some-var)"))return;let n;window.innerWidth>document.body.clientWidth?(n=window.innerWidth-document.body.clientWidth,n<5&&(n=0)):n=0,n>0&&n!==15&&requestAnimationFrame(()=>z()),document.documentElement.style.setProperty("--scroll-bar",`${n}px`),n>0?(document.documentElement.classList.add("has-scroll-bar"),document.documentElement.classList.remove("no-scroll-bar")):(document.documentElement.classList.add("no-scroll-bar"),document.documentElement.classList.remove("has-scroll-bar"))};w(()=>{z(),window.addEventListener("load",z),window.addEventListener("resize",k(z,150))});window.scrollTriggers=V;})();
