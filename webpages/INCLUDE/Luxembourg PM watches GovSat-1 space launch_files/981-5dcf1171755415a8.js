"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[981],{31981:function(e,t,i){i.d(t,{Z:function(){return O}});var n=i(52322),a=i(2784),d=i(93139),s=i(68545),r=i(4979),o=i(31549),l=i(7231),u=i(98442),c=i(63678),w=i(19832),p=i.n(w);let b=e=>{(0,a.useEffect)(()=>{let t=p()(window.embeddedMedia?.api.players(),{}),i=document.querySelectorAll('iframe[title="youtube-embed"]'),n=n=>{if(n.persisted){for(let i in t)t[i].pause(),e(!0);Array.from(i).forEach(e=>{e.contentWindow&&e.contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}',"*")})}};return window.addEventListener("pageshow",n),()=>window.removeEventListener("pageshow",n)})};var f=i(18932),m=i(23935),g=i(17433),y=i(58412),h=i(83962),v=({playlistLabels:e,blocks:t,mediaMetadataModel:i,activeIndex:n=0,onNextOnwardJourneyItemStartsPlaying:d,serviceId:s="",isWntvPrerollEnabled:r=!1,playerPosition:w,isAutoPlayDisabled:p,nextItemAutoPlay:v=!0,isAudio:A,isLiveRadio:E,playerContainerRef:x,startTime:j=0,onTimeUpdate:S,onPlaybackStarted:Z,onPlaybackPaused:C,onPlaybackEnded:O,onUserAutoplaySettingChange:_,onNextRequested:k,includeNextButton:F})=>{let[P,L]=(0,a.useState)(0),[T,$]=(0,a.useState)([]),[D,I]=(0,a.useState)(void 0),[M,R]=(0,a.useState)(!0),[N,q]=(0,a.useState)(!1),[V,W]=(0,a.useState)({duration:"",warning:""}),[B,z]=(0,a.useState)(!0),K=(0,f.Z)(),{country:Y,type:J="",allowAdvertising:U}=(0,o.Z)(),X=!p&&["video","indexPage"].includes(J),G=(0,m.Z)(),{isSignedIn:H}=(0,g.Z)(),Q=(0,l.Z)("authentication"),ee=H&&Q&&A,et=(0,l.Z)("toucan-audio"),ei=(0,l.Z)("audio-adverts"),{isSubscriptionAllowed:en,claims:ea,isSubscriptionCheckComplete:ed}=(0,u.Xe)(),{AdFreeAudio:es}=ea;return(0,a.useEffect)(()=>{if(!G||A&&!ed)return;let n=async()=>{let n;if(s||!Y||i||(0,c.P1)(Y,t[0])||(z(!1),X=!1),A&&(X=!p),!window.dotcom)return;window.dotcom.ads||y.Z.error("dotcom-bootstrap.js has failed to load");let a=()=>new Promise((e,t)=>{"DENIED"===es&&t(Error("AdFreeAudio - denied")),"ERROR"===es&&t(Error("AdFreeAudio - claims check error")),"ALLOWED"===es&&e(!0)}),o=i||(0,c.Ox)(t[0]),l=async()=>{let e=await window?.dotcom?.ads?.enabled(),t=o?.advertising??!0;if(!e||!(t&&U))return!1;if(A){if(E)return!1;if(en)try{let e=await a();return ei&&!e}catch(e){y.Z.error("areAdsEnabled:",e)}return ei}return!0},u=await l(),b="";s?(b=r&&u&&window.dotcom.ads?await window.dotcom.ads.getAdTag():"",n=(0,c.zN)(s,r&&u,b,G,e[0])):(b=window.dotcom.ads?A?await window.dotcom.ads.getAudioAdTag(o?.tritonStationId||""):await window.dotcom.ads.getAdTag():"",n=await (0,c.K$)(o,u,b,X,v,A,E,F,G,e[0],et)),n.statsObject.playerPosition=w,n.statsObject.playlistLabels={...n.statsObject.playlistLabels,ad_enabled:u,...!s&&!A&&{av_content_duration_range:"sfv"},...A&&{av_content_duration_range:"audio"}},n.startTime=j,W((0,c.l7)(n.playlistObject)),t.length>1&&$(await (0,c.YJ)(n,t,u,G,e));let f=window.embeddedMedia.api.player(x.current,n);f.bind("initialised",()=>{x.current&&(x.current.style.visibility="visible")}),f.bind("playing",()=>{R(!1);let e=window.embeddedMedia.api.players();for(let t in e){let i=e[t];i===f||i.paused()||i.pause()}}),f.bind("adsPlugin",e=>{"adStarted"===e.id&&R(!1)}),f.bind("bbc.smp.plugins.ads.event.AdsPluginExternalEvent.ALL_ADS_COMPLETED",()=>{}),f.bind("enterFakeFullscreen",()=>q(!0)),f.bind("exitFakeFullscreen",()=>q(!1)),1===t.length&&f.bind("ended",()=>R(!0)),A&&f.bind("continuousPlayChange",({status:e})=>_?.(e)),d&&f.bind("continuousPlay.play",e=>{if(e.index&&e.index!==P){let i=!0;Y&&(i=(0,c.P1)(Y,t[e.index])),z(i),i||f.pause(),L(e.index),d(e)}}),S&&f.bind("significanttimeupdate",S),ee&&f.bind("significanttimeupdate",e=>(0,h.Sp)(e,t)),Z&&f.bind("playing",Z),C&&f.bind("pause",C),O&&f.bind("ended",O),k&&f.bind("nextRequested",k),f.bind("previousRequested",()=>{f.currentTime(0)}),f.load(),I(f)};return K&&n().then(),()=>{}},[K,G,es]),(0,a.useEffect)(()=>{if(n!==P&&D){let e=!0;Y&&(e=(0,c.P1)(Y,t[n])),z(e),D.loadPlaylist(T[n].playlist,{autoplay:e,statsObject:T[n].statsObject}),L(n),W((0,c.l7)(T[n].playlist))}},[n]),(0,a.useEffect)(()=>{let e=e=>e.preventDefault();return N&&window.addEventListener("touchmove",e,{passive:!1}),()=>{window.removeEventListener("touchmove",e)}},[N]),b(R),{contentAvailableInTerritory:B,customCtaOptions:V,isCustomCtaVisible:M,isInFakeFullscreen:N,handleOnCustomCTAClick:()=>{D&&D.play(!0),R(!1)}}},A=i(29462),E=i(46964),x=i(17412),j=i(3854);let S=j.ZP.div.withConfig({componentId:"sc-12d97448-0"})(({$isAudio:e=!1})=>(0,j.iv)(["width:100%;height:auto;visibility:hidden;"," ",""],e&&(0,j.iv)(["height:100%;"]),!e&&(0,j.iv)(["aspect-ratio:16/9;"]))),Z=(0,a.forwardRef)(({isAudio:e=!1,testId:t},i)=>(0,n.jsx)(S,{"data-testid":t,ref:i,$isAudio:e}));var C=(0,a.memo)(Z),O=(0,r.Z)(({playlistLabels:e,blocks:t=[],mediaMetadataModel:i,activeIndex:r=0,testId:u="",onNextOnwardJourneyItemStartsPlaying:c,serviceId:w="",isWntvPrerollEnabled:p=!1,playerPosition:b,isAutoPlayDisabled:f,nextItemAutoPlay:m,isAudio:g=!1,isLiveRadio:y=!1,onTimeUpdate:h,onPlaybackStarted:x,onPlaybackPaused:j,onPlaybackEnded:S,onUserAutoplaySettingChange:Z,onNextRequested:O,startTime:_=0,includeNextButton:k=!0})=>{let{subtype:F}=(0,o.Z)(),P=(0,l.Z)("legacy-article-rendering-logic"),L=(0,a.useRef)(null),T=F===d.ContentSubtype.News&&!P,{contentAvailableInTerritory:$,customCtaOptions:D,isCustomCtaVisible:I,handleOnCustomCTAClick:M,isInFakeFullscreen:R}=v({playlistLabels:e,blocks:t,mediaMetadataModel:i,activeIndex:r,testId:u,onNextOnwardJourneyItemStartsPlaying:c,serviceId:w,isWntvPrerollEnabled:p,playerPosition:b,isAutoPlayDisabled:f,nextItemAutoPlay:m,isAudio:g,isLiveRadio:y,playerContainerRef:L,startTime:_,onTimeUpdate:h,onPlaybackStarted:x,onPlaybackPaused:j,onPlaybackEnded:S,onUserAutoplaySettingChange:Z,onNextRequested:O,includeNextButton:k});return(0,n.jsxs)(E.rn,{$isInFakeFullscreen:R,$isAudio:g,$withNegativeMargin:T,children:[!$&&(0,n.jsxs)(E.Ts,{children:[(0,n.jsx)(E.it,{children:A.aD}),(0,n.jsx)(E.V7,{children:A.FA})]}),(0,n.jsx)(C,{isAudio:g,ref:L,testId:u}),!g&&(0,n.jsx)(s.Z,{isVisible:I,onClick:M,...D})]})},({blocks:e,serviceId:t="",isAudio:i=!1})=>{let d=(0,a.useRef)(null),{handleOnCustomCtaClick:r,isCustomCtaVisible:o}=function({serviceId:e="",isAudio:t=!1,blocks:i,playerContainerRef:n}){let[d,s]=(0,a.useState)(!0),[r,o]=(0,a.useState)(),[l]=i,u=(0,f.Z)();return(0,a.useEffect)(()=>{let i=async()=>{let i={page:"",destination:x.q.test,producer:"BBC_STUDIOS"},a=e?(0,c.zN)(e,!1,"",i,{}):await (0,c.K$)((0,c.Ox)(l),!1,"",!1,!0,t,!1,!0,i,{},!0),d=window.embeddedMedia.api.player(n.current,a);d.bind("playing",()=>{s(!1);let e=window.embeddedMedia.api.players();for(let t in e){let i=e[t];i===d||i.paused()||i.pause()}}),d.bind("ended",()=>s(!0)),d.load(),o(d)};u&&i()},[u,t,l,n,e]),{isCustomCtaVisible:d,handleOnCustomCtaClick:()=>{r&&r.play(!0),s(!1)}}}({serviceId:t,isAudio:i,blocks:e,playerContainerRef:d});return(0,n.jsxs)(E.rn,{$isInFakeFullscreen:!1,$isAudio:i,children:[(0,n.jsx)(C,{ref:d,isAudio:i}),(0,n.jsx)(s.Z,{isVisible:o,onClick:r})]})})},29462:function(e,t,i){i.d(t,{FA:function(){return d},YI:function(){return n},aD:function(){return a}});let n={$type:"mobileFullWidth",$marginBottom:["s","m","m","m","m","m"]},a="There was an error",d="This content is not available in your location."}}]);